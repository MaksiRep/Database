create table "СУДНО"
(
	"Идентификатор" int default 5 not null
		constraint СУДНО_PK
			primary key,
	"Название" varchar2(15) not null,
	"Порт приписки" varchar2(15) not null,
	"Льгота(%)" int default 3 not null
)



create table "МЕСТА ПОГРУЗКИ"
(
	"Идентификатор" int default 3 not null
		constraint "МЕСТА ПОГРУЗКИ_PK"
			primary key,
	"Причал" varchar2(15) not null,
	"Порт" varchar2(15) not null,
	"Груз" int default 5 not null
)




create table "ГРУЗ"
(
	"Идентификатор" int default 3 not null
		constraint ГРУЗ_PK
			primary key,
	"Название" varchar2(15) not null,
	"Порт склад" varchar2(15) not null,
	"Стоимость" int default 10 not null,
	"Макс. Количество" int default 10 not null
)




create table ПОГРУЗКА
(
	"Номер ведомости" int default 3 not null
		constraint ПОГРУЗКА_PK
			primary key,
	"Дата" date not null,
	"Судно" int default 3 not null
		constraint ПОГРУЗКА_FK1
			references СУДНО,
	"Место погрузки" int default 3 not null
		constraint "ПОГРУЗКА_FK2"
			references "МЕСТА ПОГРУЗКИ",
	"Груз" int default 3 not null
		constraint ПОГРУЗКА_FK3
			references ГРУЗ,
	"Количество" int default 10 not null,
	"Стоимость" int default 10 not null
)







INSERT INTO ГРУЗ ("Идентификатор", "Название", "Порт склад", "Стоимость", "Макс. Количество")
VALUES (1, 'COMPUTERS', 'RIGA', 3000000, 10000);
INSERT INTO ГРУЗ ("Идентификатор", "Название", "Порт склад", "Стоимость", "Макс. Количество")
VALUES (2, 'PRODUCTI', 'SAKHALIN', 430000, 12300);
INSERT INTO ГРУЗ ("Идентификатор", "Название", "Порт склад", "Стоимость", "Макс. Количество")
VALUES (3, 'NEFT', 'NEW ORLEANS', 10000000, 40030);
INSERT INTO ГРУЗ ("Идентификатор", "Название", "Порт склад", "Стоимость", "Макс. Количество")
VALUES (4, 'LES', 'YUZHNY', 653000, 50000);
INSERT INTO ГРУЗ ("Идентификатор", "Название", "Порт склад", "Стоимость", "Макс. Количество")
VALUES (5, 'ORUZHIE', 'NEW YORK', 460000, 98000);
INSERT INTO ГРУЗ ("Идентификатор", "Название", "Порт склад", "Стоимость", "Макс. Количество")
VALUES (6, 'METALL', 'NAHODKA', 830000, 400000);
INSERT INTO ГРУЗ ("Идентификатор", "Название", "Порт склад", "Стоимость", "Макс. Количество")
VALUES (7, 'GAZ', 'VLADIVOSTOK', 750000, 410000);
INSERT INTO ГРУЗ ("Идентификатор", "Название", "Порт склад", "Стоимость", "Макс. Количество")
VALUES (8, 'STROIMATERIALI', 'TORONTO', 750400, 8900000);
INSERT INTO ГРУЗ ("Идентификатор", "Название", "Порт склад", "Стоимость", "Макс. Количество")
VALUES (9, 'ZHIVOTNIE', 'NAHODKA', 1900000, 350000);
INSERT INTO ГРУЗ ("Идентификатор", "Название", "Порт склад", "Стоимость", "Макс. Количество")
VALUES (10, 'HIMIKATI', 'YUZHNY', 484200, 50430);
INSERT INTO ГРУЗ ("Идентификатор", "Название", "Порт склад", "Стоимость", "Макс. Количество")
VALUES (11, 'MEDPREPARATI', 'SAKHALIN', 7592300, 463000);
INSERT INTO ГРУЗ ("Идентификатор", "Название", "Порт склад", "Стоимость", "Макс. Количество")
VALUES (12, 'TOVARI', 'RIGA', 753000, 100000);

SELECT * FROM ГРУЗ






INSERT INTO СУДНО ("Идентификатор", "Название", "Порт приписки", "Льгота(%)")
VALUES (1, 'ADMIRAL NAHIMOV','VLADIVOSTOK', 3);
INSERT INTO СУДНО ("Идентификатор", "Название", "Порт приписки", "Льгота(%)")
VALUES (2, 'BISTRY',         'NAHODKA',     2);
INSERT INTO СУДНО ("Идентификатор", "Название", "Порт приписки", "Льгота(%)")
VALUES (3, 'ADM TRADING 1',  'NEW YORK',    4);
INSERT INTO СУДНО ("Идентификатор", "Название", "Порт приписки", "Льгота(%)")
VALUES (4, 'POLAR STAR',     'BALTIMORE',   5);
INSERT INTO СУДНО ("Идентификатор", "Название", "Порт приписки", "Льгота(%)")
VALUES (5, 'JOHN GREY',      'NEW ORLEANS', 1);
INSERT INTO СУДНО ("Идентификатор", "Название", "Порт приписки", "Льгота(%)")
VALUES (6, 'LUCKY',          'TORONTO',     1);
INSERT INTO СУДНО ("Идентификатор", "Название", "Порт приписки", "Льгота(%)")
VALUES (7, 'LUNA',           'SAKHALIN',    7);
INSERT INTO СУДНО ("Идентификатор", "Название", "Порт приписки", "Льгота(%)")
VALUES (8, 'NADEZHNY',       'YUZHNY',      4);
INSERT INTO СУДНО ("Идентификатор", "Название", "Порт приписки", "Льгота(%)")
VALUES (9, 'PETROV',         'RIGA',        5);






INSERT INTO "МЕСТА ПОГРУЗКИ" ("Идентификатор", "Причал", "Порт", "Груз")
VALUES (1, 'PRICHAL 1','VLADIVOSTOK',3);
INSERT INTO "МЕСТА ПОГРУЗКИ" ("Идентификатор", "Причал", "Порт", "Груз")
VALUES (2, 'PRICHAL 2','VLADIVOSTOK',4);
INSERT INTO "МЕСТА ПОГРУЗКИ" ("Идентификатор", "Причал", "Порт", "Груз")
VALUES (3, 'PRICHAL 4','VLADIVOSTOK',5);
INSERT INTO "МЕСТА ПОГРУЗКИ" ("Идентификатор", "Причал", "Порт", "Груз")
VALUES (4, 'PRICHAL 1','NAHODKA',6)	;
INSERT INTO "МЕСТА ПОГРУЗКИ" ("Идентификатор", "Причал", "Порт", "Груз")
VALUES (5, 'PRICHAL 3','NAHODKA',3);
INSERT INTO "МЕСТА ПОГРУЗКИ" ("Идентификатор", "Причал", "Порт", "Груз")
VALUES (6, 'PRICHAL 8','NEW YORK',5);
INSERT INTO "МЕСТА ПОГРУЗКИ" ("Идентификатор", "Причал", "Порт", "Груз")
VALUES (7, 'PRICHAL 2','NEW YORK',8);
INSERT INTO "МЕСТА ПОГРУЗКИ" ("Идентификатор", "Причал", "Порт", "Груз")
VALUES (8, 'PRICHAL 3','BALTIMORE',4);
INSERT INTO "МЕСТА ПОГРУЗКИ" ("Идентификатор", "Причал", "Порт", "Груз")
VALUES (9, 'PRICHAL 6','BALTIMORE',4);
INSERT INTO "МЕСТА ПОГРУЗКИ" ("Идентификатор", "Причал", "Порт", "Груз")
VALUES (10, 'PRICHAL 1','SAKHALIN',4);
INSERT INTO "МЕСТА ПОГРУЗКИ" ("Идентификатор", "Причал", "Порт", "Груз")
VALUES (11, 'PRICHAL 2','SAKHALIN',7);
INSERT INTO "МЕСТА ПОГРУЗКИ" ("Идентификатор", "Причал", "Порт", "Груз")
VALUES (12, 'PRICHAL 3','RIGA',3);





INSERT INTO "ПОГРУЗКА" ("Номер ведомости", "Дата", "Судно", "Место погрузки", "Груз", "Количество", "Стоимость")
VALUES (1  ,TO_DATE('5.05.2002', 'dd/mm/yyyy') ,1 , 1, 2 , 6000,  5600000);
INSERT INTO "ПОГРУЗКА" ("Номер ведомости", "Дата", "Судно", "Место погрузки", "Груз", "Количество", "Стоимость")
VALUES (2  ,TO_DATE('8.06.2002', 'dd/mm/yyyy') ,1 ,12, 2 , 7000,  4356000);
INSERT INTO "ПОГРУЗКА" ("Номер ведомости", "Дата", "Судно", "Место погрузки", "Груз", "Количество", "Стоимость")
VALUES (3  ,TO_DATE('14.07.2002', 'dd/mm/yyyy'),2 , 3, 4 , 45000, 1200000 );
INSERT INTO "ПОГРУЗКА" ("Номер ведомости", "Дата", "Судно", "Место погрузки", "Груз", "Количество", "Стоимость")
VALUES (4  ,TO_DATE('17.07.2002', 'dd/mm/yyyy'),3 , 4, 5 , 34000, 328800 );
INSERT INTO "ПОГРУЗКА" ("Номер ведомости", "Дата", "Судно", "Место погрузки", "Груз", "Количество", "Стоимость")
VALUES (5  ,TO_DATE('24.07.2002', 'dd/mm/yyyy'),1 , 5, 8 , 45000, 370000);
INSERT INTO "ПОГРУЗКА" ("Номер ведомости", "Дата", "Судно", "Место погрузки", "Груз", "Количество", "Стоимость")
VALUES (6  ,TO_DATE('4.08.2002', 'dd/mm/yyyy') ,4 , 6, 12, 50089, 4100000);
INSERT INTO "ПОГРУЗКА" ("Номер ведомости", "Дата", "Судно", "Место погрузки", "Груз", "Количество", "Стоимость")
VALUES (7  ,TO_DATE('7.08.2002', 'dd/mm/yyyy') ,5 , 4, 2 , 30000, 8500000);
INSERT INTO "ПОГРУЗКА" ("Номер ведомости", "Дата", "Судно", "Место погрузки", "Груз", "Количество", "Стоимость")
VALUES (8  ,TO_DATE('14.08.2002', 'dd/mm/yyyy'),1 , 8, 4 , 20000, 2600000);
INSERT INTO "ПОГРУЗКА" ("Номер ведомости", "Дата", "Судно", "Место погрузки", "Груз", "Количество", "Стоимость")
VALUES (9  ,TO_DATE('19.08.2002', 'dd/mm/yyyy'),6 , 9, 7 , 67000, 4200000);
INSERT INTO "ПОГРУЗКА" ("Номер ведомости", "Дата", "Судно", "Место погрузки", "Груз", "Количество", "Стоимость")
VALUES (10 ,TO_DATE('25.08.2002', 'dd/mm/yyyy'),8 ,11, 8 , 67008, 3400000);
INSERT INTO "ПОГРУЗКА" ("Номер ведомости", "Дата", "Судно", "Место погрузки", "Груз", "Количество", "Стоимость")
VALUES (11 ,TO_DATE('5.09.2002', 'dd/mm/yyyy') ,9 ,12, 3 , 10000, 850000);
INSERT INTO "ПОГРУЗКА" ("Номер ведомости", "Дата", "Судно", "Место погрузки", "Груз", "Количество", "Стоимость")
VALUES (12 ,TO_DATE('9.09.2002', 'dd/mm/yyyy') ,9 ,1 , 6 , 13000, 34000000);
INSERT INTO "ПОГРУЗКА" ("Номер ведомости", "Дата", "Судно", "Место погрузки", "Груз", "Количество", "Стоимость")
VALUES (13 ,TO_DATE('1.10.2002', 'dd/mm/yyyy') ,5 ,2 , 7 , 78000, 4200000);
INSERT INTO "ПОГРУЗКА" ("Номер ведомости", "Дата", "Судно", "Место погрузки", "Груз", "Количество", "Стоимость")
VALUES (14 ,TO_DATE('7.10.2002', 'dd/mm/yyyy') ,4 ,3 , 3 , 50000, 948000);
INSERT INTO "ПОГРУЗКА" ("Номер ведомости", "Дата", "Судно", "Место погрузки", "Груз", "Количество", "Стоимость")
VALUES (15 ,TO_DATE('15.10.2002', 'dd/mm/yyyy'),3 ,7 , 9 , 43000, 5340000);
INSERT INTO "ПОГРУЗКА" ("Номер ведомости", "Дата", "Судно", "Место погрузки", "Груз", "Количество", "Стоимость")
VALUES (16 ,TO_DATE('21.10.2002', 'dd/mm/yyyy'),2 ,6 , 4 , 9000,  3260000);
INSERT INTO "ПОГРУЗКА" ("Номер ведомости", "Дата", "Судно", "Место погрузки", "Груз", "Количество", "Стоимость")
VALUES (17 ,TO_DATE('8.11.2002', 'dd/mm/yyyy') ,2 ,3 , 1 , 7000,  4270000);
INSERT INTO "ПОГРУЗКА" ("Номер ведомости", "Дата", "Судно", "Место погрузки", "Груз", "Количество", "Стоимость")
VALUES (18 ,TO_DATE('18.11.2002', 'dd/mm/yyyy'),8 ,4 , 9 , 50000, 5400000);
INSERT INTO "ПОГРУЗКА" ("Номер ведомости", "Дата", "Судно", "Место погрузки", "Груз", "Количество", "Стоимость")
VALUES (19 ,TO_DATE('27.11.2002', 'dd/mm/yyyy'),7 ,5 , 10, 60000, 4300000);
INSERT INTO "ПОГРУЗКА" ("Номер ведомости", "Дата", "Судно", "Место погрузки", "Груз", "Количество", "Стоимость")
VALUES (20 ,TO_DATE('8.12.2002', 'dd/mm/yyyy') ,7 ,6 , 11, 45000, 4360000);
INSERT INTO "ПОГРУЗКА" ("Номер ведомости", "Дата", "Судно", "Место погрузки", "Груз", "Количество", "Стоимость")
VALUES (21 ,TO_DATE('18.12.2002', 'dd/mm/yyyy'),9 ,2 , 11, 83000, 150000 );


SQL 

1.) Вывести все различные названия судов, их льгот и мест погрузки (порт, причал).
Сортировка по названию.

SELECT "Название", "Льгота(%)", "Порт", "Причал"
FROM СУДНО
         JOIN "МЕСТА ПОГРУЗКИ" "М П" on СУДНО."Идентификатор" = "М П"."Идентификатор"
order by "Название"




2.)Найти названия судов, производивших погрузку в тех чужих портах, где
отчисления на погрузку более 3%.

SELECT "Название"
FROM СУДНО
         JOIN "МЕСТА ПОГРУЗКИ" on СУДНО."Идентификатор" = "МЕСТА ПОГРУЗКИ"."Идентификатор"
WHERE "Груз" > 3 AND "Порт приписки" != "МЕСТА ПОГРУЗКИ"."Порт"
ORDER BY "Порт"



3.)Найти суда, не производившие погрузки в причалах порта VLADIVOSTOK.
Вывести название судов, и места погрузки (порт, причал). Сортировать по порту.

SELECT "Название"
FROM СУДНО
         JOIN "МЕСТА ПОГРУЗКИ" on СУДНО."Идентификатор" = "МЕСТА ПОГРУЗКИ"."Идентификатор"
WHERE "Порт" != 'VLADIVOSTOK'
ORDER BY "Порт"



4.)Определить порт приписки судна, производившего самую дорогую погрузку в
период с 1 июня 2002г. по 1 сентября 2002 г.
Вывести название судна, порт приписки

SELECT "Название", "Порт приписки"
FROM (SELECT "Судно"
      FROM (SELECT MAX("Стоимость") as max
            FROM СУДНО
                     JOIN ПОГРУЗКА П on СУДНО."Идентификатор" = П."Судно"
            WHERE "Дата" > TO_DATE('1.06.2002', 'dd/mm/yyyy')
              AND "Дата" < TO_DATE('1.09.2002', 'dd/mm/yyyy')) su
               JOIN ПОГРУЗКА on "Стоимость" = max
     )
JOIN СУДНО on "Судно" = СУДНО."Идентификатор"



5.)Найти места погрузки, на которых проходила погрузка всех судов из RIGA или
BALTIMORE в период с 1 мая 2002г. до 15 октября 2002г.
Вывести места погрузки (порт, причал).

SELECT "Порт", "Причал"
FROM СУДНО
         JOIN ПОГРУЗКА П on СУДНО."Идентификатор" = П."Судно"
         JOIN "МЕСТА ПОГРУЗКИ" "М П" on "М П"."Идентификатор" = П."Место погрузки"
WHERE "Дата" > TO_DATE('1.05.2002', 'dd/mm/yyyy')
  AND "Дата" < TO_DATE('15.10.2002', 'dd/mm/yyyy')
  AND ("Порт приписки" = 'RIGA' OR "Порт приписки" = 'BALTIMORE')



6.)Найти среди тех судов, которые производили погрузку в портах NAHODKA и
VLADIVOSTOK, такие, которые имеют льготы меньше среднего.
Вывести название судов

SELECT "Название"
FROM (SELECT *
      FROM СУДНО
      WHERE "Льгота(%)" < (SELECT AVG("Льгота(%)") FROM СУДНО)) su
JOIN ПОГРУЗКА on "Судно" = su."Идентификатор"
JOIN "МЕСТА ПОГРУЗКИ" on "МЕСТА ПОГРУЗКИ"."Идентификатор" = ПОГРУЗКА."Место погрузки"
WHERE "Порт" = 'NAHODKA' OR "Порт" = 'VLADIVOSTOK'
group by "Название"